<!DOCTYPE html>
<html>
<head>

    <title>CodeLearn</title>
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <script type="text/javascript" src="index.js"></script>
  </head>
   <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
  <body>

    <div class="topnav">
      <a class="active" href="#home">Home</a>
      <a href="#languages">Languages</a>
      <a href="#about">About</a>
      <a href="#contact">Contact Us</a>
      <a href="login.html" id="logout" >Log Out</a>
    </div>

    <div class="intro">
      <h1 class="logo"> CodeLearn </h1>
      <!-- <p>Select a language  from below and make corrections to the displayed code.</p> -->
    </div>
    <!-- <hr> -->
    <div class="body">

        <div class="split left">

          <form id = "question_generator" method = "POST">
              <h2>Select Language:</h2>
              <label class="container">Python
                <input type="radio" checked="checked" name="radio" value = "python">
                <span class="checkmark"></span>
              </label>
              <label class="container">C
                <input type="radio" name="radio" value = "c">
                <span class="checkmark"></span>
              </label>
              <!-- <label class="container">C++
                <input type="radio" name="radio">
                <span class="checkmark"></span>
              </label> -->

              <h2>Category: </h2>
              <select class = "category" name = "category">
                  <option value = "functions" selected="selected">functions</option>
                  <option value = "if_else">if_else</option>
                  <option value = "loop">loop</option>
                  <option value = "toy_programs">toy_programs</option>

              </select>

              <h2>Program: </h2>
              <select class = "category" name = "category">
                  <option value = "double.py" selected="selected">double.py</option>
                  <option value = "helloworld.py">helloworld.py</option>
                  <option value = "square.py">square.py</option>
                  <option value = "temp.py">temp.py</option>

              </select>

              <button class="generate_code" onclick="fetch_code(event)">FETCH CODE</button>
              <!-- <input class = "generate_code" type = "submit" value = "FETCH CODE"> -->

          </form>
          <p><tt id="results"></tt></p>
        </div>

        <div class="split right">

            <h2>Code Segment: </h2>
            <textarea id="codesegment" wrap=on rows="14" cols="140" >


            </textarea>
            <input type="submit" class="submit" value="SUBMIT" ></input>

        </div>

        <div class="split right-most">
          <h2>Score: </h2>
            <h1 id="score">0</h1>
        </div>

    </div>

  </body>
</html>

    <script>

        var server_addr="http://0.0.0.0:80"
        var route="/"
        function fetch_code(e) {
            e.preventDefault();
            let myForm = document.getElementById('question_generator');
            let formData = new FormData(myForm);
            values = [];
            for (var value of formData.values()) {
              values.push(value);
            }
            var data_file = server_addr+route;
            var http_request = new XMLHttpRequest();
            var language = values[0];
            var type = values[1];
            var params =JSON.stringify([language,type]);
            console.log(params);
            // alert(params);
            http_request.onreadystatechange = function() {//Call a function when the state changes.
                if(http_request.readyState == 4) {
                    // var jsonObj = JSON.parse(http_request.responseText);
                    var response = http_request.responseText;
                    console.log(response);
                    p = document.getElementById("codesegment");
                    p.innerHTML = response;
                    // alert(response)
                    // console.log(http_request.responseText)
                    // alert(http_request.responseText)
                    // console.log(jsonObj)
                    // alert(jsonObj)
                }
            }
            http_request.open('POST', data_file, true);
            http_request.send(params);
        }

    </script>
